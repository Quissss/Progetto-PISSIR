@page
@model Progetto.App.Pages.DashMwBotModel
@{
    ViewData["Title"] = "Dashboard MwBots";
}

<h2>@ViewData["Title"]</h2>

<div id="mwBotGrid"></div>

@section Scripts {
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.js"></script>
    <script>
        const url = "/api/MwBot";

        let ajax = function (item, verb, json = true) {
            return $.ajax({
                type: verb,
                url: url ,
                data: json ? JSON.stringify(item) : item,
                dataType: "json",
                contentType: json ? "application/json" : "text/plain",
            });
        };

        $(function () {
            $("#mwBotGrid").jsGrid({
                width: "100%",
                height: "400px",
                autoload: true,
                filtering: true,
                inserting: true,
                editing: true,
                sorting: true,
                paging: true,
                controller: {
                    loadData: function (filter) {
                        return ajax(filter, "GET", false);
                    },
                    updateItem: function (item) {
                        return ajax(item, "PUT");
                    },
                    insertItem: function (item) {
                        return ajax(item, "POST");
                    },
                    deleteItem: function (item) {
                        return ajax(item, "DELETE");
                    }
                },
                fields: [
                    { name: "id", type: "number", width: 50, title: "ID", readOnly: true },
                    { name: "batteryPercentage", type: "number", width: 150, title: "Battery Percentage" },
                    {
                        name: "status", type: "select", width: 150, title: "Status", items: [
                            { Name: "Offline", Id: 0 },
                            { Name: "StandBy", Id: 1 },
                            { Name: "ChargingCar", Id: 2 },
                            { Name: "Recharging", Id: 3 },
                            { Name: "MovingToSlot", Id: 4 },
                            { Name: "MovingToDock", Id: 5 }
                        ], valueField: "Id", textField: "Name"
                    },
                    {
                        type: "control",
                        editButton: true,
                        deleteButton: true,
                    }
                ]
            });
        });
    </script>
}